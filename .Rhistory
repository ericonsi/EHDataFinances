library(Hmisc)
library(psych)
library(tidyverse)
library(skimr)
library(purrr)
library(tidyr)
library(tidyverse)
library(gridExtra)
library(lubridate)
library(fastDummies)
library(data.table)
library(mltools)
library(MASS)
library(car)
library(patchwork)
library(ggthemes)
library(tinytex)
library(stats)
library(ggsci)
library(scales)
library(naniar)
library(caret)
library(pROC)
library(methods)
library(sf)
library(mapproj)
library(maps)
#library(rnaturalearth)
library(rnaturalearthdata)
library(usmap)
library(tsibbledata)
library(tsibble)
library(forecast)
library(fpp3)
library(fable)
library(lme4)
library(rvest)
library(factoextra)
library(gridGraphics)
library(kableExtra)
library(anytime)
unloadNamespace("EHDataFinances")
devtools::install_github("ericonsi/EHDataFinances")
library(EHDataFinances)
# Import data
dfExpenses <- EHFinances_ImportRawAccountFiles("2601")[[1]]
dfCategories <- EHFinances_ImportCategories()
# Assign Categories and Shocks
dfExpenses2 <- EHFinances_AssignAccountsToDelete(dfExpenses)
dfExpenses3 <- EHFinances_AssignCategoriesAndSubcategories(dfExpenses2)
dfExpenses4 <- EHFinances_AssignTrips(dfExpenses3, "2025-12-28", "2026-01-08", "Rio")
View(dfExpenses3)
View(dfExpenses4)
View(dfExpenses3)
View(dfExpenses4)
View(dfExpenses3)
knitr::opts_chunk$set(echo = FALSE, warning =  FALSE, message = FALSE)
library(XML)
library(RCurl)
library(rlist)
library(auk)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(lubridate)
library(readr)
library(sf)
unloadNamespace("EHData")
devtools::install_github("ericonsi/EHData")
library(EHData)
library(devtools)
library(roxygen2)
library(Hmisc)
library(psych)
library(tidyverse)
library(skimr)
library(purrr)
library(tidyr)
library(tidyverse)
library(gridExtra)
library(lubridate)
library(fastDummies)
library(data.table)
library(mltools)
library(MASS)
library(car)
library(patchwork)
library(ggthemes)
library(tinytex)
library(stats)
library(ggsci)
library(scales)
library(naniar)
library(caret)
library(pROC)
library(methods)
library(sf)
library(mapproj)
library(maps)
#library(rnaturalearth)
library(rnaturalearthdata)
library(usmap)
library(tsibbledata)
library(tsibble)
library(forecast)
library(fpp3)
library(fable)
library(lme4)
library(rvest)
library(factoextra)
library(gridGraphics)
library(kableExtra)
library(anytime)
unloadNamespace("EHDataFinances")
devtools::install_github("ericonsi/EHDataFinances")
library(EHDataFinances)
# Import data
dfExpenses <- EHFinances_ImportRawAccountFiles("2601")[[1]]
dfCategories <- EHFinances_ImportCategories()
# Assign Categories and Shocks
dfExpenses2 <- EHFinances_AssignAccountsToDelete(dfExpenses)
dfExpenses3 <- EHFinances_AssignCategoriesAndSubcategories(dfExpenses2)
dfExpenses4 <- EHFinances_AssignTrips(dfExpenses3, "2025-12-28", "2026-01-08", "Rio")
# Assign Categories and Shocks
dfExpenses2 <- EHFinances_AssignAccountsToDelete(dfExpenses)
dfExpenses3 <- EHFinances_AssignCategoriesAndSubcategories(dfExpenses2)
dfExpenses4 <- EHFinances_AssignTrips(dfExpenses3, "2025-12-28", "2026-01-08", "Rio")
knitr::opts_chunk$set(echo = FALSE, warning =  FALSE, message = FALSE)
library(XML)
library(RCurl)
library(rlist)
library(auk)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(lubridate)
library(readr)
library(sf)
unloadNamespace("EHData")
devtools::install_github("ericonsi/EHData")
library(EHData)
library(devtools)
library(roxygen2)
library(Hmisc)
library(psych)
library(tidyverse)
library(skimr)
library(purrr)
library(tidyr)
library(tidyverse)
library(gridExtra)
library(lubridate)
library(fastDummies)
library(data.table)
library(mltools)
library(MASS)
library(car)
library(patchwork)
library(ggthemes)
library(tinytex)
library(stats)
library(ggsci)
library(scales)
library(naniar)
library(caret)
library(pROC)
library(methods)
library(sf)
library(mapproj)
library(maps)
#library(rnaturalearth)
library(rnaturalearthdata)
library(usmap)
library(tsibbledata)
library(tsibble)
library(forecast)
library(fpp3)
library(fable)
library(lme4)
library(rvest)
library(factoextra)
library(gridGraphics)
library(kableExtra)
library(anytime)
unloadNamespace("EHDataFinances")
devtools::install_github("ericonsi/EHDataFinances")
library(EHDataFinances)
# Import data
dfExpenses <- EHFinances_ImportRawAccountFiles("2601")[[1]]
dfCategories <- EHFinances_ImportCategories()
# Assign Categories and Shocks
dfExpenses2 <- EHFinances_AssignAccountsToDelete(dfExpenses)
dfExpenses3 <- EHFinances_AssignCategoriesAndSubcategories(dfExpenses2)
dfExpenses4 <- EHFinances_AssignTrips(dfExpenses3, "2025-12-28", "2026-01-08", "Rio")
View(dfExpenses4)
roxygenise()
knitr::opts_chunk$set(echo = FALSE, warning =  FALSE, message = FALSE)
library(XML)
library(RCurl)
library(rlist)
library(auk)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(lubridate)
library(readr)
library(sf)
unloadNamespace("EHData")
devtools::install_github("ericonsi/EHData")
library(EHData)
library(devtools)
library(roxygen2)
library(Hmisc)
library(psych)
library(tidyverse)
library(skimr)
library(purrr)
library(tidyr)
library(tidyverse)
library(gridExtra)
library(lubridate)
library(fastDummies)
library(data.table)
library(mltools)
library(MASS)
library(car)
library(patchwork)
library(ggthemes)
library(tinytex)
library(stats)
library(ggsci)
library(scales)
library(naniar)
library(caret)
library(pROC)
library(methods)
library(sf)
library(mapproj)
library(maps)
#library(rnaturalearth)
library(rnaturalearthdata)
library(usmap)
library(tsibbledata)
library(tsibble)
library(forecast)
library(fpp3)
library(fable)
library(lme4)
library(rvest)
library(factoextra)
library(gridGraphics)
library(kableExtra)
library(anytime)
unloadNamespace("EHDataFinances")
devtools::install_github("ericonsi/EHDataFinances")
library(EHDataFinances)
# Import data
dfExpenses <- EHFinances_ImportRawAccountFiles("2601")[[1]]
dfCategories <- EHFinances_ImportCategories()
# Assign Categories and Shocks
dfExpenses2 <- EHFinances_AssignAccountsToDelete(dfExpenses)
dfExpenses3 <- EHFinances_AssignCategoriesAndSubcategories(dfExpenses2)
dfExpenses4 <- EHFinances_AssignTrips(dfExpenses3, "2025-12-28", "2026-01-08", "Rio")
dfExpenses5 <- EHFinances_AssignRuby(dfExpenses4)
# Assign Categories and Shocks
dfExpenses2 <- EHFinances_AssignAccountsToDelete(dfExpenses)
dfExpenses3 <- EHFinances_AssignCategoriesAndSubcategories(dfExpenses2)
dfExpenses4 <- EHFinances_AssignTrips(dfExpenses3, "2025-12-28", "2026-01-08", "Rio")
dfExpenses5 <- EHFinances_AssignRuby(dfExpenses4)
View(dfExpenses5)
#Complete Categories
dfConsolidatedExpense7 <- dfExpenses5 |>
mutate(Category=if_else(zCategory=="Travel" & zSupercedesTrip ==0, zCategory, Category)) |>
mutate(Category=if_else(zCategory!="Travel" & zCategory!="NA", zCategory, Category)) |>
mutate(SubCategory=if_else(zCategory=="Travel" & zSupercedesTrip ==0, zSubCategory, SubCategory)) |>
mutate(SubCategory=if_else(zCategory!="Travel" & zSubCategory!="NA", zSubCategory, SubCategory)) |>
dplyr::mutate(Category = if_else(Category=="Groceries" & Amount < 20, "Food & Drink", Category)) |>
dplyr::mutate(SubCategory=if_else(Category=="Groceries" & SubCategory=="NA", "Other", SubCategory)) |>
dplyr::mutate(SubCategory = if_else(Category=="Gas", "Gas", SubCategory)) |>
dplyr::mutate(Category = if_else(Category=="Gas", "Car", Category)) |>
mutate(SubCategory = if_else(Category=="Food & Drink", "NA", SubCategory)) |>
dplyr::mutate(Amount=round(Amount,2)) |>
dplyr::select(ID, Corrected, `Transaction Date`, Description, Category, SubCategory, Amount, Source, ToDelete, SupercedesTrip, Memo, Type)
#Complete Categories
dfConsolidatedExpense7 <- dfExpenses5 |>
mutate(Category=if_else(zCategory=="Travel" & SupercedesTrip ==0, zCategory, Category)) |>
mutate(Category=if_else(zCategory!="Travel" & zCategory!="NA", zCategory, Category)) |>
mutate(SubCategory=if_else(zCategory=="Travel" & SupercedesTrip ==0, zSubCategory, SubCategory)) |>
mutate(SubCategory=if_else(zCategory!="Travel" & zSubCategory!="NA", zSubCategory, SubCategory)) |>
dplyr::mutate(Category = if_else(Category=="Groceries" & Amount < 20, "Food & Drink", Category)) |>
dplyr::mutate(SubCategory=if_else(Category=="Groceries" & SubCategory=="NA", "Other", SubCategory)) |>
dplyr::mutate(SubCategory = if_else(Category=="Gas", "Gas", SubCategory)) |>
dplyr::mutate(Category = if_else(Category=="Gas", "Car", Category)) |>
mutate(SubCategory = if_else(Category=="Food & Drink", "NA", SubCategory)) |>
dplyr::mutate(Amount=round(Amount,2)) |>
dplyr::select(ID, Corrected, `Transaction Date`, Description, Category, SubCategory, Amount, Source, ToDelete, SupercedesTrip, Memo, Type)
View(dfConsolidatedExpense7)
#Complete Categories
dfConsolidatedExpense7 <- dfExpenses5 |>
mutate(Category=if_else(zCategory=="Travel" & SupercedesTrip ==0, zCategory, Category)) |>
mutate(Category=if_else(zCategory!="Travel" & zCategory!="NA", zCategory, Category)) |>
mutate(SubCategory=if_else(zCategory=="Travel" & SupercedesTrip ==0, zSubCategory, SubCategory)) |>
mutate(SubCategory=if_else(zCategory!="Travel" & zSubCategory!="NA", zSubCategory, SubCategory)) |>
dplyr::mutate(Category = if_else(Category=="Groceries" & Amount < 20, "Food & Drink", Category)) |>
dplyr::mutate(SubCategory=if_else(Category=="Groceries" & SubCategory=="NA", "Other", SubCategory)) |>
dplyr::mutate(SubCategory = if_else(Category=="Gas", "Gas", SubCategory)) |>
dplyr::mutate(Category = if_else(Category=="Gas", "Car", Category)) |>
mutate(SubCategory = if_else(Category=="Food & Drink", "Uncategprized", SubCategory)) |>
dplyr::mutate(Amount=round(Amount,2)) |>
dplyr::select(ID, Corrected, `Transaction Date`, Description, Category, SubCategory, Amount, Source, ToDelete, SupercedesTrip, Memo, Type)
#Complete Categories
dfConsolidatedExpense7 <- dfExpenses5 |>
mutate(Category=if_else(zCategory=="Travel" & SupercedesTrip ==0, zCategory, Category)) |>
mutate(Category=if_else(zCategory!="Travel" & zCategory!="NA", zCategory, Category)) |>
mutate(SubCategory=if_else(zCategory=="Travel" & SupercedesTrip ==0, zSubCategory, SubCategory)) |>
mutate(SubCategory=if_else(zCategory!="Travel" & zSubCategory!="NA", zSubCategory, SubCategory)) |>
dplyr::mutate(Category = if_else(Category=="Groceries" & Amount < 20, "Food & Drink", Category)) |>
dplyr::mutate(SubCategory=if_else(Category=="Groceries" & SubCategory=="NA", "Other", SubCategory)) |>
dplyr::mutate(SubCategory = if_else(Category=="Gas", "Gas", SubCategory)) |>
dplyr::mutate(Category = if_else(Category=="Gas", "Car", Category)) |>
mutate(SubCategory = if_else(Category=="Food & Drink", "Uncategorized", SubCategory)) |>
dplyr::mutate(Amount=round(Amount,2)) |>
dplyr::select(ID, Corrected, `Transaction Date`, Description, Category, SubCategory, Amount, Source, ToDelete, SupercedesTrip, Memo, Type)
# Assign Categories and Shocks
dfExpenses2 <- EHFinances_AssignAccountsToDelete(dfExpenses)
dfExpenses3 <- EHFinances_AssignCategoriesAndSubcategories(dfExpenses2)
dfExpenses4 <- EHFinances_AssignTrips(dfExpenses3, "2025-12-28", "2026-01-08", "Rio")
dfExpenses5 <- EHFinances_AssignRuby(dfExpenses4)
#Complete Categories
dfConsolidatedExpense7 <- dfExpenses5 |>
mutate(Category=if_else(zCategory=="Travel" & SupercedesTrip ==0, zCategory, Category)) |>
mutate(Category=if_else(zCategory!="Travel" & zCategory!="NA", zCategory, Category)) |>
mutate(SubCategory=if_else(zCategory=="Travel" & SupercedesTrip ==0, zSubCategory, SubCategory)) |>
mutate(SubCategory=if_else(zCategory!="Travel" & zSubCategory!="NA", zSubCategory, SubCategory)) |>
dplyr::mutate(Category = if_else(Category=="Groceries" & Amount < 20, "Food & Drink", Category)) |>
dplyr::mutate(SubCategory=if_else(Category=="Groceries" & SubCategory=="NA", "Other", SubCategory)) |>
dplyr::mutate(SubCategory = if_else(Category=="Gas", "Gas", SubCategory)) |>
dplyr::mutate(Category = if_else(Category=="Gas", "Car", Category)) |>
mutate(SubCategory = if_else(Category=="Food & Drink", "Uncategorized", SubCategory)) |>
dplyr::mutate(Amount=round(Amount,2)) |>
dplyr::select(ID, Corrected, `Transaction Date`, Description, Category, SubCategory, Amount, Source, ToDelete, SupercedesTrip, Memo, Type)
rxyg
roxygenise()
# Assign Categories and Shocks
dfExpenses2 <- EHFinances_AssignAccountsToDelete(dfExpenses)
dfExpenses3 <- EHFinances_AssignCategoriesAndSubcategories(dfExpenses2)
dfExpenses4 <- EHFinances_AssignTrips(dfExpenses3, "2025-12-28", "2026-01-08", "Rio")
dfExpenses5 <- EHFinances_AssignRuby(dfExpenses4)
dfExpenses6 <- EHFinances_ApplyBusinessRules(dfExpenses5)
View(dfExpenses6)
# Assign Categories and Shocks
dfExpenses2 <- EHFinances_AssignCategoriesAndSubcategories(dfExpenses)
dfExpenses3 <- EHFinances_AssignTrips(dfExpenses2, "2025-12-28", "2026-01-08", "Rio")
dfExpenses4 <- EHFinances_AssignRuby(dfExpenses3)
dfExpenses5 <- EHFinances_AssignAccountsToDelete(dfExpenses4)
dfExpenses6 <- EHFinances_ApplyBusinessRules(dfExpenses5)
roxygenise()
knitr::opts_chunk$set(echo = FALSE, warning =  FALSE, message = FALSE)
library(XML)
library(RCurl)
library(rlist)
library(auk)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(lubridate)
library(readr)
library(sf)
unloadNamespace("EHData")
devtools::install_github("ericonsi/EHData")
library(EHData)
library(devtools)
library(roxygen2)
library(Hmisc)
library(psych)
library(tidyverse)
library(skimr)
library(purrr)
library(tidyr)
library(tidyverse)
library(gridExtra)
library(lubridate)
library(fastDummies)
library(data.table)
library(mltools)
library(MASS)
library(car)
library(patchwork)
library(ggthemes)
library(tinytex)
library(stats)
library(ggsci)
library(scales)
library(naniar)
library(caret)
library(pROC)
library(methods)
library(sf)
library(mapproj)
library(maps)
#library(rnaturalearth)
library(rnaturalearthdata)
library(usmap)
library(tsibbledata)
library(tsibble)
library(forecast)
library(fpp3)
library(fable)
library(lme4)
library(rvest)
library(factoextra)
library(gridGraphics)
library(kableExtra)
library(anytime)
unloadNamespace("EHDataFinances")
devtools::install_github("ericonsi/EHDataFinances")
library(EHDataFinances)
# Import data
dfExpenses <- EHFinances_ImportRawAccountFiles("2601")[[1]]
dfCategories <- EHFinances_ImportCategories()
# Assign Categories and Shocks
dfExpenses2 <- EHFinances_AssignCategoriesAndSubcategories(dfExpenses)
dfExpenses3 <- EHFinances_AssignTrips(dfExpenses2, "2025-12-28", "2026-01-08", "Rio")
dfExpenses4 <- EHFinances_AssignRuby(dfExpenses3)
dfExpenses5 <- EHFinances_AssignAccountsToDelete(dfExpenses4)
dfExpenses6 <- EHFinances_ApplyBusinessRules(dfExpenses5)
EHFinances_WriteOrOpenOverrideFile(Folder="2601")
EHFinances_WriteOrOpenOverrideFile(Folder="2601", xType = "Create")
EHFinances_WriteOrOpenOverrideFile(dfExpenses6, Folder="2601", xType = "Create")
library(XML)
library(RCurl)
library(rlist)
library(auk)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(lubridate)
library(readr)
library(sf)
unloadNamespace("EHData")
devtools::install_github("ericonsi/EHData")
library(EHData)
library(devtools)
library(roxygen2)
library(Hmisc)
library(psych)
library(tidyverse)
library(skimr)
library(purrr)
library(tidyr)
library(tidyverse)
library(gridExtra)
library(lubridate)
library(fastDummies)
library(data.table)
library(mltools)
library(MASS)
library(car)
library(patchwork)
library(ggthemes)
library(tinytex)
library(stats)
library(ggsci)
library(scales)
library(naniar)
library(caret)
library(pROC)
library(methods)
library(sf)
library(mapproj)
library(maps)
#library(rnaturalearth)
library(rnaturalearthdata)
library(usmap)
library(tsibbledata)
library(tsibble)
library(forecast)
library(fpp3)
library(fable)
library(lme4)
library(rvest)
library(factoextra)
library(gridGraphics)
library(kableExtra)
library(anytime)
unloadNamespace("EHDataFinances")
devtools::install_github("ericonsi/EHDataFinances")
library(EHDataFinances)
EHFinances_WriteOrOpenOverrideFile(dfExpenses6, Folder="2601", xType = "Create")
OverrideFileWritten=FALSE
If(OverrideFileWritten){
OverrideFileWritten=FALSE
if(OverrideFileWritten){
dfExpenses7 <- EHFinances_WriteOrOpenOverrideFile(Folder="2601")
} else {
EHFinances_WriteOrOpenOverrideFile(dfExpenses6, Folder="2601", xType = "Create")
}
OverrideFileWritten=TRUE
if(OverrideFileWritten){
dfExpenses7 <- EHFinances_WriteOrOpenOverrideFile(Folder="2601")
} else {
EHFinances_WriteOrOpenOverrideFile(dfExpenses6, Folder="2601", xType = "Create")
}
return("Completed")
source("D:/RStudio/EHDataFinances/R/EHDataFinances.R", echo=TRUE)
OverrideFileWritten=TRUE
if(OverrideFileWritten){
dfExpenses7 <- EHFinances_WriteOrOpenOverrideFile(Folder="2601")
} else {
EHFinances_WriteOrOpenOverrideFile(dfExpenses6, Folder="2601", xType = "Create")
}
View(dfExpenses7)
